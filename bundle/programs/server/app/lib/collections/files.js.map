{"version":3,"sources":["meteor://ðŸ’»app/lib/collections/files.js"],"names":[],"mappings":";;;;;;;;AAAA,KAAK,GAAG,IAAI,KAAK,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;;;;AAItC,KAAK,CAAC,KAAK,CAAC;;AAET,OAAM,EAAE,YAAW;AAAC,SAAO,IAAI;EAAC;;AAEjC,OAAM,EAAE,YAAW;AAAC,SAAO,IAAI;EAAC;;AAEjC,OAAM,EAAE,YAAW;AAAC,SAAO,IAAI;EAAC;CAChC,CAAC,CAAC;;AAEH,IAAG,MAAM,CAAC,QAAQ,EAAE;;AAEnB,KAAI,EAAE,GAAG,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;AAC3B,KAAI,MAAM,GAAG,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;AACnC,KAAI,SAAS,GAAG,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC;;AAE1C,OAAM,CAAC,OAAO,CAAC;;AAEd,YAAU,EAAE,UAAS,IAAI,EAAE;;AAE1B,OAAI,IAAI,CAAC,IAAI,IAAI,QAAQ;AACxB,UAAM,CAAC,SAAS,GAAC,GAAG,GAAC,IAAI,CAAC,OAAO,GAAC,GAAG,GAAC,IAAI,CAAC,IAAI,GAAC,GAAG,GAAC,IAAI,CAAC,MAAM,EAAE,UAAU,GAAG,EAAE;AAAC,YAAO,CAAC,GAAG,CAAC,GAAG,CAAC;KAAC,CAAC,CAAC;AAEjG,MAAE,CAAC,UAAU,CAAC,SAAS,GAAE,GAAG,GAAC,IAAI,CAAC,QAAQ,EAAE,UAAU,GAAG,EAAE;AAAC,YAAO,CAAC,GAAG,CAAC,GAAG,CAAC;KAAC,CAAC,CAAC;GACjF;EACH,CAAC;CACF,wE","file":"/lib/collections/files.js","sourcesContent":["Files = new Mongo.Collection('files'); // Store all files\n\n// TODO : add server-side security\n\nFiles.allow({\n\n  \tinsert: function() {return true},\n\n \tremove: function() {return true},\n\n\tupdate: function() {return true}\n});\n\nif(Meteor.isServer) {\n\n\tvar fs = Npm.require('fs');\n\tvar rimraf = Npm.require('rimraf'); // Package to delete directories\n\tvar uploadDir = Meteor.settings.uploadDir;\n\n\tMeteor.methods({\n\n\t\tdeleteFile: function(post) {\n\n\t\t\tif (post.type == 'lesson') // Remove directory (each storline lesson is stored in is own directory)\n\t\t\t\trimraf(uploadDir+\"/\"+post.spaceId+\"/\"+post.type+\"/\"+post.fileId, function (err) {console.log(err)});\n\t\t\telse // Remove the file\n    \t\t\tfs.unlinkSync(uploadDir +\"/\"+post.filePath, function (err) {console.log(err)});\n  \t\t}\n\t})\n}"]}