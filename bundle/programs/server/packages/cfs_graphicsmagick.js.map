{"version":3,"sources":["meteor://ðŸ’»app/packages/cfs_graphicsmagick/packages/cfs_graphicsmagick.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sG","file":"/packages/cfs_graphicsmagick.js","sourcesContent":["(function () {\n\n////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                        //\n// packages/cfs:graphicsmagick/gm.js                                                      //\n//                                                                                        //\n////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                          //\nvar nodegm = Npm.require('gm');                                                           // 1\nvar path = Npm.require('path');                                                           // 2\nvar fs = Npm.require('fs');                                                               // 3\n                                                                                          // 4\ngm = function() {                                                                         // 5\n  throw new Error('cfs:graphicsmagick could not find \"graphicsMagick\" or \"imageMagick\"'); // 6\n};                                                                                        // 7\n                                                                                          // 8\nvar graphicsmagick = false;                                                               // 9\nvar imagemagick = false;                                                                  // 10\n                                                                                          // 11\n// Split the path by : or ;                                                               // 12\n// XXX: windows is not tested                                                             // 13\nvar binaryPaths = process.env['PATH'].split(/:|;/);                                       // 14\n                                                                                          // 15\n// XXX: we should properly check if we can access the os temp folder - since              // 16\n// gm binaries are using this and therefore may fail?                                     // 17\n                                                                                          // 18\n// XXX: we could push extra paths if the `gm` library check stuff like:                   // 19\n// $MAGIC_HOME The current version does not check there                                   // 20\n// $MAGICK_HOME (GraphicsMagick docs)                                                     // 21\n                                                                                          // 22\n// We check to see if we can find binaries                                                // 23\nfor (var i = 0; i < binaryPaths.length; i++) {                                            // 24\n  var binPath = binaryPaths[i];                                                           // 25\n                                                                                          // 26\n  // If we have not found GraphicsMagic                                                   // 27\n  if (!graphicsmagick) {                                                                  // 28\n    // Init                                                                               // 29\n    var gmPath = path.join(binPath, 'gm');                                                // 30\n    var gmExePath = path.join(binPath, 'gm.exe');                                         // 31\n                                                                                          // 32\n    // Check to see if binary found                                                       // 33\n    graphicsmagick = fs.existsSync(gmPath) || fs.existsSync(gmExePath);                   // 34\n                                                                                          // 35\n    // If GraphicsMagic we dont have to check for ImageMagic                              // 36\n    // Since we prefer GrapicsMagic when selecting api                                    // 37\n    if (!graphicsmagick && !imagemagick) {                                                // 38\n      // Init paths to check                                                              // 39\n      var imPath = path.join(binPath, 'convert');                                         // 40\n      var imExePath = path.join(binPath, 'convert.exe');                                  // 41\n                                                                                          // 42\n      // Check to see if binary found                                                     // 43\n      imagemagick = fs.existsSync(imPath) || fs.existsSync(imExePath);                    // 44\n                                                                                          // 45\n    }                                                                                     // 46\n  }                                                                                       // 47\n}                                                                                         // 48\n                                                                                          // 49\n                                                                                          // 50\nif (!graphicsmagick && !imagemagick) {                                                    // 51\n  // Both failed                                                                          // 52\n  console.warn(                                                                           // 53\n    'WARNING:\\n' +                                                                        // 54\n    'cfs:graphicsmagick could not find \"graphicsMagic\" or \"imageMagic\" on the\\n' +        // 55\n    'system.\\n' +                                                                         // 56\n    '\\n' +                                                                                // 57\n    'I just checked PATH to see if I could find the GraphicsMagick or ImageMagic\\n' +     // 58\n    'unix/mac os/windows binaries on your system, I failed.\\n' +                          // 59\n    '\\n' +                                                                                // 60\n    'Why:\\n' +                                                                            // 61\n    '1. I may be blind or naive, help making me smarter\\n' +                              // 62\n    '2. You havent added the path to the binaries\\n' +                                    // 63\n    '3. You havent actually installed GraphicsMagick or ImageMagick\\n' +                  // 64\n    '\\n' +                                                                                // 65\n    '*** Make sure \"$PATH\" environment is configured \"PATH:/path/to/binaries\" ***\\n' +    // 66\n    '\\n' +                                                                                // 67\n    'Installation hints:\\n' +                                                             // 68\n    '* Mac OS X \"brew install graphicsmagick\" or \"brew install imagemagick\"\\n' +          // 69\n    '* Linux download rpm or use packagemanager\\n' +                                      // 70\n    '* Centos \"yum install GraphicsMagick\"' +                                             // 71\n    '* Windows download the installer and run'                                            // 72\n  );                                                                                      // 73\n                                                                                          // 74\n  gm.isAvailable = false;                                                                 // 75\n                                                                                          // 76\n} else {                                                                                  // 77\n  // Rig the gm scope                                                                     // 78\n                                                                                          // 79\n  if (graphicsmagick) {                                                                   // 80\n    // Prefer graphicsmagick                                                              // 81\n    gm = nodegm;                                                                          // 82\n  } else {                                                                                // 83\n    // Use imageMagick - we subclass for the user                                         // 84\n    var imageMagick = nodegm.subClass({ imageMagick: true });                             // 85\n    gm = imageMagick;                                                                     // 86\n  }                                                                                       // 87\n                                                                                          // 88\n  gm.isAvailable = true;                                                                  // 89\n}                                                                                         // 90\n                                                                                          // 91\n////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n"]}